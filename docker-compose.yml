<<<<<<< HEAD
services:
  db:
    image: postgres:15
    environment:
      POSTGRES_PASSWORD: pass
      POSTGRES_DB: mcp_db
    ports:
      - "5432:5432"
  orchestrator:
    build: .
    depends_on:
      - db
    environment:
      DATABASE_URL: postgresql://postgres:pass@db:5432/mcp_db

  rbac:
    build: ./rbac
    ports:
      - "8001:8001"
    environment:
      RBAC_SECRET: dev-secret-change-me
=======
version: "3.9"
services:
  postgres:
    image: postgres:15
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
      POSTGRES_DB: worldos
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
  redis:
    image: redis:7
    ports:
      - "6379:6379"
  anvil:
    image: ghcr.io/foundry-rs/foundry:latest
    entrypoint: anvil
    command: ["--host", "0.0.0.0", "--port", "8545", "--mnemonic", "test test test test test test test test test test test junk"]
    ports:
      - "8545:8545"
  api:
    build: ./apps/api
    command: pnpm dev
    environment:
      DATABASE_URL: postgresql://postgres:postgres@postgres:5432/worldos
      REDIS_URL: redis://redis:6379
      CHAIN_RPC: http://anvil:8545
      CHAIN_PRIVATE_KEY: 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
      MINTER_PRIVATE_KEY: 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
      WALLET_VERIFIER_DOMAIN: world-os
      WALLET_VERIFIER_VERSION: "1"
      API_URL: http://localhost:3001
      WEB_URL: http://localhost:5173
      FORGE_QUEUE_NAME: asset-forge
      CONTRACT_ADDRESS: ""
    ports:
      - "3001:3001"
    depends_on:
      - postgres
      - redis
      - anvil
  web:
    build: ./apps/web
    command: pnpm dev -- --host 0.0.0.0 --port 5173
    environment:
      VITE_API_URL: http://localhost:3001
    ports:
      - "5173:5173"
    depends_on:
      - api
  worker:
    build: ./apps/worker
    command: pnpm dev
    environment:
      DATABASE_URL: postgresql://postgres:postgres@postgres:5432/worldos
      REDIS_URL: redis://redis:6379
      FORGE_QUEUE_NAME: asset-forge
    depends_on:
      - postgres
      - redis
volumes:
  postgres_data:
>>>>>>> core-orchestrator/ci-migration-gh-actions-3099626751256413922
