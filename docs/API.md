# A2A Orchestrator API Documentation

The Orchestrator Hub provides a unified interface for triggering multi-agent workflows.

## Endpoints

### 1. Orchestrate Flow

`POST /orchestrate`

Triggers the full **ManagingAgent → OrchestrationAgent → ArchitectureAgent → CoderAgent → TesterAgent** pipeline for a given query.

**Parameters:**

| Name | Type | In | Description |
| :--- | :--- | :--- | :--- |
| `user_query` | `string` | Query | The natural language task for the agents to perform. |

**Example Request:**

```bash
curl -X 'POST' \
  'http://localhost:8000/orchestrate?user_query=Build%20a%20Fibonacci%20generator' \
  -H 'accept: application/json'
```

**Success Response (200 OK):**

```json
{
  "status": "A2A Workflow Complete",
  "success": true,
  "pipeline_results": {
    "plan_id": "plan-abc123",
    "blueprint_id": "bp-def456",
    "code_artifacts": ["art-ghi789"]
  },
  "final_code": "... (Generated Python code) ...",
  "test_summary": "Passed: 1/1"
}
```

---

### 2. Plan Ingress

`POST /plans/ingress`

Triggers a plan state-machine transition via the Stateflow FSM. Used for webhook-driven plan orchestration.

**Body (JSON):**

| Name | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| `plan_id` | `string` | No | Canonical plan identifier. |
| `plan_file_path` | `string` | No | File path containing plan ID in its basename. |

At least one of `plan_id` or `plan_file_path` must be provided.

**Example Request:**

```bash
curl -X 'POST' \
  'http://localhost:8000/plans/ingress' \
  -H 'Content-Type: application/json' \
  -d '{"plan_id": "plan-abc123"}'
```

**Success Response (200 OK):**

```json
{
  "status": "scheduled",
  "plan_id": "plan-abc123",
  "transition": {
    "from_state": "IDLE",
    "to_state": "SCHEDULED",
    "event": "OBJECTIVE_INGRESS",
    "timestamp": 1707700000.0,
    "meta": {}
  }
}
```

---

## Artifact Schemas

All data exchanged between agents follows the `MCPArtifact` Pydantic model:

| Field | Type | Description |
| --- | --- | --- |
| `artifact_id` | `string` | Unique identifier for the output. |
| `type` | `string` | One of: `research_doc`, `code_solution`, `test_report`. |
| `content` | `string` | The payload generated by the agent. |
| `agent_name` | `string` | Name of the producing agent. |
| `version` | `string` | Schema version. |
| `parent_artifact_id` | `string?` | Parent artifact in the trace chain. |
| `timestamp` | `string` | ISO 8601 creation timestamp. |
| `metadata` | `object` | Key-value pairs containing agent versions and model info. |
